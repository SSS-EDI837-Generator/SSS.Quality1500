# WARP.md

This file provides guidance to WARP (warp.dev) when working with code in this repository.

## Project Overview
**SSS.Quality1500** is a WPF desktop application for healthcare claims quality review (CMS-1500 forms). Built with .NET 10 using Clean Architecture and strict MVVM.

## Commands

```bash
# Restore dependencies
dotnet restore

# Build (Debug)
dotnet build

# Build (Release)
dotnet build -c Release

# Run the application
dotnet run --project SSS.Quality1500.Presentation

# Clean build artifacts
dotnet clean
```

## Architecture

### Dependency Flow (innermost to outermost)
```
Common ← Domain ← Data ← Business ← Presentation
```

### Layer Responsibilities
- **Common**: Transversal utilities only (environment detection, version info, lazy services). No business logic, NO dependency on other layers.
- **Domain**: Entities, Value Objects, `Result<T,E>`, and interfaces (contracts). No framework dependencies.
- **Data**: Implements Domain contracts (DBF readers via NDbfReader, SQLite via EF Core).
- **Business**: Orchestrates use cases using Domain entities and Data implementations. Contains LoggerInitializer.
- **Presentation**: WPF + MVVM with CommunityToolkit.Mvvm and MaterialDesignThemes.

Each layer has a `LAYER.md` with detailed documentation.

## Key Patterns

### Result Pattern (`Domain/Models/Result.cs`)
Use `Result<TSuccess, TFailure>` instead of exceptions for expected failures:
```csharp
Result<DataTable, string> result = await service.GetDataAsync();
result.OnSuccess(data => Process(data))
      .OnFailure(error => Log(error));
```

### Dependency Injection
Register services in each layer's `Extensions/ServiceCollectionExtensions.cs`:
- `AddCommonServices()` → `AddDataServices(config)` → `AddBusinessServices(config)`

Contracts are defined in **Domain**, implementations in **Data**:
```csharp
// Domain: IDbfReader (contract)
// Data: DbfReader (implementation)
services.AddTransient<IDbfReader, DbfReader>();
```

### MVVM Rules
- **No code-behind** (except `InitializeComponent`)
- Use `[ObservableProperty]` and `[RelayCommand]` from CommunityToolkit.Mvvm
- Dialogs via `IDialogService`, navigation via services

### Aggregates
Place aggregates in `Aggregates/` folder, contracts in `Aggregates/Abstractions/`.

## Tech Stack
- **.NET 10** (net10.0-windows for Presentation)
- **WPF** with MaterialDesignThemes 5.x
- **CommunityToolkit.Mvvm** for MVVM infrastructure
- **NDbfReader** for DBF file access
- **EF Core + SQLite** for persistence
- **Serilog** for logging

## Code Conventions
- File-scoped namespaces
- Primary constructors when applicable
- Explicit types for simple types (not `var`)
- Max 500 lines per .cs file (excluding autogenerated)
- Max 3 parameters in constructors/methods
